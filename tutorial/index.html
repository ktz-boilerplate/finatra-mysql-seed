<!DOCTYPE html><html><head><meta charset="utf-8"><title>Untitled Document.md</title><style></style></head><body id="preview">
<h1><a id="Finatra_Mysql_Seed_Project_0"></a>Finatra Mysql Seed Project</h1>
<p><a href="https://twitter.github.io/finatra/">Finatra</a> +
<a href="https://github.com/typesafehub/config">TypesafeConfig</a> +
<a href="https://github.com/xiaodongw/swagger-finatra">Swagger</a> +
<a href="http://slick.typesafe.com/">Slick</a> +
<a href="http://getquill.io/">Quill</a> with
<a href="https://www.mysql.com/">Mysql</a> seed Project</p>
<h2><a id="Development_Environments_8"></a>Development Environments</h2>
<h3><a id="Requirements_9"></a>Requirements</h3>
<ul>
<li><a href="http://www.scala-lang.org/">Scala 2.11.x</a></li>
<li><a href="http://www.oracle.com/technetwork/java/javase/downloads/jdk8-downloads-2133151.html">Java 8</a> - <a href="https://github.com/typesafehub/config#binary-releases">Typesafe Config(1.3.0) only supports Java 8</a></li>
<li><a href="https://www.mysql.com/">Mysql</a></li>
</ul>
<h3><a id="Dependencies_14"></a>Dependencies</h3>
<ul>
<li><a href="https://twitter.github.io/finatra/">Finatra</a> - Fast, testable, Scala services built on <a href="http://twitter.github.io/twitter-server/">TwitterServer</a> and <a href="https://twitter.github.io/finagle">Finagle</a>.</li>
<li><a href="https://github.com/google/guice/wiki/Motivation">Guice</a> - a lightweight dependency injection framework for Java 6 and above by Google.</li>
<li><a href="http://slick.typesafe.com/">Slick</a> - Functional Relational Mapping for Scala.</li>
<li><a href="http://brettwooldridge.github.io/HikariCP/">HikariCP</a> - A high-performance JDBC connection pool.</li>
<li><a href="http://getquill.io/">Quill</a> - Alternative to <strong>Slick</strong>, <a href="http://twitter.github.io/finagle/guide/Protocols.html#mysql">finagle-mysql</a></li>
<li><a href="http://www.scalatest.org/">ScalaTest</a> - A testing tool for Scala and Java developers.</li>
<li><a href="https://github.com/typesafehub/config">TypesafeConfig</a> - Configuration library for JVM languages.</li>
<li><a href="http://logback.qos.ch/">Logback</a> - The Generic, Reliable, Fast &amp; Flexible Logging Framework.</li>
<li><a href="https://github.com/xiaodongw/swagger-finatra">Swagger</a> - Add Swagger support for Finatra web framework.</li>
</ul>
<h2><a id="Development_Resource_Links_25"></a>Development Resource Links</h2>
<ul>
<li><a href="http://twitter.github.io/scala_school/index.html">Scala School</a></li>
<li><a href="https://github.com/twitter/util#futures">Twitter Future</a></li>
<li><a href="http://twitter.github.io/finatra/user-guide/">Finatra User Guide</a></li>
<li><a href="http://twitter.github.io/finatra/presentations/">Finatra Presentations</a></li>
<li><a href="https://github.com/twitter/finatra/tree/master/examples">Finatra Examples Projects</a></li>
<li><a href="https://github.com/google/guice/wiki/Motivation">Guice Wiki</a></li>
</ul>
<h2><a id="How_to_use_This_Template_34"></a>How to use This Template</h2>
<p>Option 1. if you have activator</p>
<pre><code class="language-bash">activator new PROJECTNAME finatra-mysql-seed
</code></pre>
<p>Option 2. Just git clone this project and use sbt</p>
<pre><code class="language-bash">git <span class="hljs-built_in">clone</span> git@github.com:ikhoon/finatra-mysql-seed.git
</code></pre>
<h2><a id="Getting_Started_45"></a>Getting Started</h2>
<h3><a id="Install_MySQL_on_Mac_OSX_using_Homebrew_47"></a>Install MySQL on Mac OSX using Homebrew</h3>
<pre><code class="language-bash">brew install mysql
<span class="hljs-comment"># start mysql-server</span>
mysqld
</code></pre>
<h3><a id="Start_Server_with_activator_54"></a>Start Server with activator</h3>
<pre><code class="language-bash"><span class="hljs-comment"># clone repostitory</span>
git <span class="hljs-built_in">clone</span> git@github.com:ikhoon/finatra-mysql-seed.git

<span class="hljs-built_in">cd</span> finatra-mysql-seed/

<span class="hljs-comment"># initialize mysql table &amp; data</span>
mysql -u root &lt; sql/<span class="hljs-number">1</span>.sql

<span class="hljs-comment"># Start finatra server</span>
./activator run
...
[info] Loading project definition from finatra-mysql-seed/project
[info] Set current project to finatra-mysql-seed(<span class="hljs-keyword">in</span> build file:finatra-mysql-seed/)
[info] Running com.example.ktz.FinatraServerMain
...
</code></pre>
<h2><a id="Example_Codes_75"></a>Example Codes</h2>
<h3><a id="Add_Sample_Controller_77"></a>Add Sample Controller</h3>
<pre><code class="language-scala"><span class="hljs-comment">// add new file SampleController.scala</span>
<span class="hljs-keyword">import</span> com.twitter.finagle.http.<span class="hljs-type">Request</span>
<span class="hljs-keyword">import</span> com.twitter.finatra.http.<span class="hljs-type">Controller</span>

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">SampleController</span> <span class="hljs-keyword"><span class="hljs-keyword">extends</span></span> <span class="hljs-title">Controller</span> {</span>

  <span class="hljs-comment">// GET register /ping uri</span>
  get(<span class="hljs-string">"/ping"</span>) { request: <span class="hljs-type">Request</span> =&gt;
    <span class="hljs-comment">// Define Response</span>
    <span class="hljs-string">"pong"</span>
  }
}
</code></pre>
<h3><a id="Register_Controller_and_Router_on_FinatraServerhttpsgithubcomikhoonfinatramysqlseedblobmastersrcmainscalacomgithubikhoonFinatraServerscala_94"></a>Register Controller and Router on <a href="https://github.com/ikhoon/finatra-mysql-seed/blob/master/src/main/scala/com/github/ikhoon/FinatraServer.scala">FinatraServer</a></h3>
<pre><code class="language-scala"><span class="hljs-class"><span class="hljs-keyword">object</span> <span class="hljs-title">FinatraServerMain</span> <span class="hljs-keyword"><span class="hljs-keyword">extends</span></span> <span class="hljs-title">FinatraServer</span>
</span>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">FinatraServer</span> <span class="hljs-keyword"><span class="hljs-keyword">extends</span></span> <span class="hljs-title">HttpServer</span> {</span>

  <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">configureHttp</span>(</span>router: <span class="hljs-type">HttpRouter</span>) {
    router
      .add[<span class="hljs-type">SampleController</span>]  <span class="hljs-comment">// Register your Controller</span>
  }
}
</code></pre>
<h3><a id="Mysql_Access_with_Quill_107"></a>Mysql Access with Quill</h3>
<h4><a id="Define_Quill_Module_109"></a>Define Quill Module</h4>
<pre><code class="language-scala"><span class="hljs-keyword">import</span> com.google.inject.{ <span class="hljs-type">Singleton</span>, <span class="hljs-type">Provides</span> }
<span class="hljs-keyword">import</span> com.twitter.inject.<span class="hljs-type">TwitterModule</span>
<span class="hljs-keyword">import</span> com.typesafe.config.<span class="hljs-type">Config</span>
<span class="hljs-keyword">import</span> io.getquill.<span class="hljs-type">FinagleMysqlSourceConfig</span>
<span class="hljs-keyword">import</span> io.getquill.naming.<span class="hljs-type">SnakeCase</span>
<span class="hljs-keyword">import</span> io.getquill._
<span class="hljs-keyword">import</span> io.getquill.sources.finagle.mysql.<span class="hljs-type">FinagleMysqlSource</span>

<span class="hljs-class"><span class="hljs-keyword">object</span> <span class="hljs-title">QuillDatabaseModule</span> <span class="hljs-keyword"><span class="hljs-keyword">extends</span></span> <span class="hljs-title">TwitterModule</span> {</span>

  <span class="hljs-class"><span class="hljs-keyword">type</span> <span class="hljs-title">QuillDatabaseSource</span> =</span> <span class="hljs-type">FinagleMysqlSource</span>[<span class="hljs-type">SnakeCase</span>]

  <span class="hljs-annotation">@Provides</span> <span class="hljs-annotation">@Singleton</span>
  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">provideDataBaseSource</span>(</span>conf: <span class="hljs-type">Config</span>): <span class="hljs-type">QuillDatabaseSource</span> = source(<span class="hljs-keyword">new</span> <span class="hljs-type">FinagleMysqlSourceConfig</span>[<span class="hljs-type">SnakeCase</span>](<span class="hljs-string">""</span>) {
    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">config</span> =</span> conf.getConfig(<span class="hljs-string">"quill.db"</span>)
  })

}
</code></pre>
<h4><a id="Inject_Quill_using_Guice_131"></a>Inject Quill using Guice</h4>
<pre><code class="language-scala"><span class="hljs-comment">// Define model</span>
<span class="hljs-keyword">case</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Users</span>(</span> id: <span class="hljs-type">Int</span>, name: <span class="hljs-type">String</span>, createdAt: <span class="hljs-type">Date</span>)

<span class="hljs-comment">// Define repository</span>
<span class="hljs-keyword">import</span> javax.inject.{ <span class="hljs-type">Inject</span>, <span class="hljs-type">Singleton</span> }

<span class="hljs-keyword">import</span> com.example.ktz.modules.<span class="hljs-type">QuillDatabaseModule</span>.<span class="hljs-type">QuillDatabaseSource</span>
<span class="hljs-keyword">import</span> com.twitter.util.<span class="hljs-type">Future</span>
<span class="hljs-keyword">import</span> io.getquill._

<span class="hljs-annotation">@Singleton</span>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">QuillUserRepository</span> <span class="hljs-title">@Inject</span>(</span>) (db: <span class="hljs-type">QuillDatabaseSource</span>) {

  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">findById</span>(</span>id: <span class="hljs-type">Int</span>): <span class="hljs-type">Future</span>[<span class="hljs-type">Option</span>[<span class="hljs-type">Users</span>]] = {
    <span class="hljs-function"><span class="hljs-keyword">val</span> <span class="hljs-title">q</span> =</span> quote { (id: <span class="hljs-type">Int</span>) =&gt;
      query[<span class="hljs-type">Users</span>].filter(i =&gt; i.id == id).take(<span class="hljs-number">1</span>)
    }
    db.run(q)(id).map(_.headOption)
  }

}
</code></pre>
<h3><a id="Mysql_Access_with_Slick_156"></a>Mysql Access with Slick</h3>
<h4><a id="Define_Slick_Module_158"></a>Define Slick Module</h4>
<pre><code class="language-scala"><span class="hljs-keyword">import</span> javax.inject.<span class="hljs-type">Singleton</span>

<span class="hljs-keyword">import</span> com.google.inject.<span class="hljs-type">Provides</span>
<span class="hljs-keyword">import</span> com.twitter.inject.<span class="hljs-type">TwitterModule</span>
<span class="hljs-keyword">import</span> com.typesafe.config.<span class="hljs-type">Config</span>

<span class="hljs-class"><span class="hljs-keyword">object</span> <span class="hljs-title">SlickDatabaseModule</span> <span class="hljs-keyword"><span class="hljs-keyword">extends</span></span> <span class="hljs-title">TwitterModule</span> {</span>
  <span class="hljs-keyword">import</span> slick.driver.<span class="hljs-type">MySQLDriver</span>.api._
  <span class="hljs-class"><span class="hljs-keyword">type</span> <span class="hljs-title">SlickDataBaseSource</span> =</span> slick.driver.<span class="hljs-type">MySQLDriver</span>.api.<span class="hljs-type">Database</span>

  <span class="hljs-annotation">@Singleton</span> <span class="hljs-annotation">@Provides</span>
  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">provideDatabase</span>(</span>config: <span class="hljs-type">Config</span>): <span class="hljs-type">SlickDataBaseSource</span> = <span class="hljs-type">Database</span>.forConfig(<span class="hljs-string">"slick.db"</span>, config)

}
</code></pre>
<h4><a id="Inject_Slick_using_Guice_176"></a>Inject Slick using Guice</h4>
<pre><code class="language-scala"><span class="hljs-comment">// Define model</span>
<span class="hljs-keyword">import</span> org.joda.time.<span class="hljs-type">DateTime</span>
<span class="hljs-keyword">case</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Users</span>(</span>id: <span class="hljs-type">Long</span>, name: <span class="hljs-type">String</span>, createdAt: <span class="hljs-type">DateTime</span>)

<span class="hljs-comment">// Define slick table &amp; repository</span>
<span class="hljs-keyword">import</span> javax.inject.<span class="hljs-type">Inject</span>

<span class="hljs-keyword">import</span> com.example.ktz.modules.<span class="hljs-type">SlickDatabaseModule</span>.<span class="hljs-type">SlickDataBaseSource</span>
<span class="hljs-keyword">import</span> com.github.tototoshi.slick.<span class="hljs-type">MySQLJodaSupport</span>._
<span class="hljs-keyword">import</span> org.joda.time.<span class="hljs-type">DateTime</span>

<span class="hljs-keyword">import</span> scala.concurrent.<span class="hljs-type">ExecutionContext</span>.<span class="hljs-type">Implicits</span>.global
<span class="hljs-keyword">import</span> scala.concurrent.<span class="hljs-type">Future</span>

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">SlickUserRepository</span> <span class="hljs-title">@Inject</span>(</span>) (db: <span class="hljs-type">SlickDataBaseSource</span>) {

  <span class="hljs-keyword">import</span> driver.api._
  <span class="hljs-keyword">private</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">UserTable</span>(</span>tag: <span class="hljs-type">Tag</span>) <span class="hljs-keyword">extends</span> <span class="hljs-type">Table</span>[<span class="hljs-type">Users</span>](tag, <span class="hljs-string">"users"</span>) {
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">id</span> =</span> column[<span class="hljs-type">Long</span>](<span class="hljs-string">"id"</span>, <span class="hljs-type">O</span>.<span class="hljs-type">PrimaryKey</span>)
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">name</span> =</span> column[<span class="hljs-type">String</span>](<span class="hljs-string">"name"</span>)
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">createdAt</span> =</span> column[<span class="hljs-type">DateTime</span>](<span class="hljs-string">"created_at"</span>)
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">*</span> =</span> (id, name, createdAt) &lt;&gt; ((<span class="hljs-type">Users</span>.apply _).tupled, <span class="hljs-type">Users</span>.unapply)
  }

  <span class="hljs-keyword">private</span> <span class="hljs-function"><span class="hljs-keyword">val</span> <span class="hljs-title">users</span> =</span> <span class="hljs-type">TableQuery</span>[<span class="hljs-type">UserTable</span>]

  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">findById</span>(</span>id: <span class="hljs-type">Long</span>): <span class="hljs-type">Future</span>[<span class="hljs-type">Option</span>[<span class="hljs-type">Users</span>]] = {
    db.run {
      users.filter(_.id === id).take(<span class="hljs-number">1</span>).result
    }.map(_.headOption)
  }
}
</code></pre>
<h3><a id="Http_Programming_with_Finagle_Http_Client_212"></a>Http Programming with Finagle Http Client</h3>
<h4><a id="Define_default_HTTP_Host_headerhttpswwww3orgProtocolsrfc2616rfc2616sec14htmlsec1423_for_finagle_http_client_214"></a>Define default <a href="https://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html#sec14.23">HTTP Host header</a> for finagle http client</h4>
<blockquote>
<p>Otherwise <a href="https://github.com/twitter/finatra/blob/develop/httpclient/src/main/scala/com/twitter/finatra/httpclient/RequestBuilder.scala">finatra http client request builder</a> doesn’t work.</p>
</blockquote>
<pre><code class="language-scala"><span class="hljs-keyword">abstract</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">BasicHttpClientModule</span>(</span>) <span class="hljs-keyword">extends</span> <span class="hljs-type">TwitterModule</span> {

  <span class="hljs-keyword">protected</span> <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">provideHttpClient</span>(</span>mapper: <span class="hljs-type">FinatraObjectMapper</span>, host: <span class="hljs-type">String</span>, port: <span class="hljs-type">Int</span> = <span class="hljs-number">80</span>): <span class="hljs-type">HttpClient</span> = {
    <span class="hljs-function"><span class="hljs-keyword">val</span> <span class="hljs-title">httpClientModule</span> =</span> <span class="hljs-keyword">new</span> <span class="hljs-type">HttpClientModule</span> {
      <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">dest</span>:</span> <span class="hljs-type">String</span> = s<span class="hljs-string">"$host:$port"</span>
      <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">defaultHeaders</span>:</span> <span class="hljs-type">Map</span>[<span class="hljs-type">String</span>, <span class="hljs-type">String</span>] = <span class="hljs-type">Map</span>(<span class="hljs-string">"Host"</span> -&gt; host)
    }
    httpClientModule.provideHttpClient(mapper, httpClientModule.provideHttpService)
  }
}
</code></pre>
<h4><a id="Create_HttpClient_Module_with_host_and_port_230"></a>Create HttpClient Module with host and port</h4>
<pre><code class="language-scala"><span class="hljs-class"><span class="hljs-keyword">object</span> <span class="hljs-title">FakeHttpClientModule</span> {</span>
  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">apply</span>(</span>) = <span class="hljs-keyword">new</span> <span class="hljs-type">BasicHttpClientModule</span> {
    <span class="hljs-annotation">@Named</span>(<span class="hljs-string">"fake"</span>) <span class="hljs-annotation">@Provides</span> <span class="hljs-annotation">@Singleton</span>
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">provideHttpClient</span>(</span>mapper: <span class="hljs-type">FinatraObjectMapper</span>, config: <span class="hljs-type">Config</span>) =
      <span class="hljs-keyword">super</span>.provideHttpClient(mapper, config.as[<span class="hljs-type">String</span>](<span class="hljs-string">"fake.host"</span>), config.as[<span class="hljs-type">Int</span>](<span class="hljs-string">"fake.port"</span>))
  }
}
</code></pre>
<h4><a id="Resister_HttpClient_on_FinatraServer_241"></a>Resister HttpClient on FinatraServer</h4>
<pre><code class="language-scala"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">FinatraServer</span> <span class="hljs-keyword"><span class="hljs-keyword">extends</span></span> <span class="hljs-title">HttpServer</span> {</span>
  <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">modules</span> =</span> <span class="hljs-type">Seq</span>(<span class="hljs-type">FakeHttpClientModule</span>())
  ...
}

<span class="hljs-comment">// Use Http Client</span>
<span class="hljs-comment">// file : FackService.scala</span>
<span class="hljs-keyword">import</span> javax.inject.{ <span class="hljs-type">Inject</span>, <span class="hljs-type">Named</span> }

<span class="hljs-keyword">import</span> com.fasterxml.jackson.databind.<span class="hljs-type">JsonNode</span>
<span class="hljs-keyword">import</span> com.twitter.finatra.httpclient.{ <span class="hljs-type">HttpClient</span>, <span class="hljs-type">RequestBuilder</span> }
<span class="hljs-keyword">import</span> com.twitter.util.<span class="hljs-type">Future</span>
<span class="hljs-keyword">import</span> com.typesafe.config.<span class="hljs-type">Config</span>
<span class="hljs-keyword">import</span> net.ceedubs.ficus.<span class="hljs-type">Ficus</span>._

<span class="hljs-comment">// inject httpClient using @Named("fake") annotation</span>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">FakeService</span> <span class="hljs-title">@Inject</span>(</span>) (<span class="hljs-annotation">@Named</span>(<span class="hljs-string">"fake"</span>) httpClient: <span class="hljs-type">HttpClient</span>, config: <span class="hljs-type">Config</span>) {
  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">withSleep</span>(</span>sec: <span class="hljs-type">Int</span>): <span class="hljs-type">Future</span>[<span class="hljs-type">JsonNode</span>] = {
    <span class="hljs-function"><span class="hljs-keyword">val</span> <span class="hljs-title">url</span> =</span> config.as[<span class="hljs-type">String</span>](<span class="hljs-string">"fake.host"</span>) + s<span class="hljs-string">"?sleep=$sec"</span>
    httpClient.executeJson[<span class="hljs-type">JsonNode</span>](<span class="hljs-type">RequestBuilder</span>.get(url))
  }
}
</code></pre>
<h2><a id="Auto_Restart_FinatraServer_using_spraysbtresolverhttpsgithubcomspraysbtrevolver_267"></a>Auto Restart FinatraServer using <a href="https://github.com/spray/sbt-revolver">spray/sbt-resolver</a></h2>
<pre><code class="language-bash">./activator <span class="hljs-string">"~re-start"</span>
...
[info] Loading project definition from finatra-mysql-seed/project
[info] Set current project to finatra-mysql-seed(<span class="hljs-keyword">in</span> build file:finatra-mysql-seed/)
...
</code></pre>
<h2><a id="Create_a_fat_JAR_with_compact_all_of_its_dependencies_276"></a>Create a fat JAR with compact all of its dependencies</h2>
<pre><code class="language-bash"><span class="hljs-comment"># build single jar</span>
./activator assembly
...
[info] Assembly up to date: finatra-mysql-seed/target/scala-<span class="hljs-number">2.11</span>/finatra-mysql-seed.jar
[success] Total time: <span class="hljs-number">10</span> s, completed Dec <span class="hljs-number">3</span>, <span class="hljs-number">2015</span> <span class="hljs-number">5</span>:<span class="hljs-number">08</span>:<span class="hljs-number">01</span> PM
</code></pre>
<h2><a id="Start_Standalone_Server_285"></a>Start Standalone Server</h2>
<pre><code class="language-bash"><span class="hljs-built_in">cd</span> target/scala-<span class="hljs-number">2.11</span>/
<span class="hljs-comment"># Development mode with default logback.xml</span>
java -jar finatra-mysql-seed.jar -mode dev
<span class="hljs-comment"># Production mode with specified logback config file</span>
java -jar -Dlogback.configurationFile=conf/real-logback.xml finatra-mysql-seed.jar -mode real
</code></pre>
<h2><a id="Run_modes_294"></a>Run modes</h2>
<h3><a id="devdefault_295"></a>dev(default)</h3>
<p>Run with <a href="./src/main/resources/conf/dev.conf"><code>resources/conf/dev.conf</code></a> &amp; <a href="./src/main/resources/logback.xml"><code>resources/logback.xml</code></a></p>
<h3><a id="Custom_run_mode_needs_two_files_298"></a>Custom run mode needs two files</h3>
<ul>
<li>typesafe config : src/main/resources/conf/xxx.conf</li>
<li>logback.xml : src/main/resources/conf/xxx-logback.xml</li>
<li>Run <code>java -jar -Dlogback.configurationFile=conf/xxx-logback.xml finatra-mysql-seed.jar -mode xxx</code></li>
</ul>
<h3><a id="Show_Twitter_Server_flagshttptwittergithubiofinatrauserguidegettingstartedflags_303"></a>Show <a href="http://twitter.github.io/finatra/user-guide/getting-started/#flags">Twitter Server flags</a></h3>
<pre><code class="language-bash">java -jar finatra-mysql-seed.jar -help
...
flags:
  -help=<span class="hljs-string">'false'</span>: Show this <span class="hljs-built_in">help</span>
  -http.announce=<span class="hljs-string">'java.lang.String'</span>: Address to announce HTTP server to
  -http.name=<span class="hljs-string">'http'</span>: Http server name
  -http.port=<span class="hljs-string">':9999'</span>: External HTTP server port
  -https.announce=<span class="hljs-string">'java.lang.String'</span>: Address to announce HTTPS server to
  -https.name=<span class="hljs-string">'https'</span>: Https server name
  -https.port=<span class="hljs-string">''</span>: HTTPs Port
  -key.path=<span class="hljs-string">''</span>: path to SSL key
  -local.doc.root=<span class="hljs-string">''</span>: File serving directory <span class="hljs-keyword">for</span> <span class="hljs-built_in">local</span> development
  -log.append=<span class="hljs-string">'true'</span>: If <span class="hljs-literal">true</span>, appends to existing logfile. Otherwise, file is truncated.
  -log.async=<span class="hljs-string">'true'</span>: Log asynchronously
  -log.async.maxsize=<span class="hljs-string">'4096'</span>: Max queue size <span class="hljs-keyword">for</span> async logging
  -log.level=<span class="hljs-string">'INFO'</span>: Log level
  -log.output=<span class="hljs-string">'/dev/stderr'</span>: Output file
  -maxRequestSize=<span class="hljs-string">'5242880.bytes'</span>: HTTP(s) Max Request Size
<span class="hljs-comment"># set run mode with `-mode`</span>
  -mode=<span class="hljs-string">'dev'</span>: application run mode [dev:default, alpha, sandbox, beta, real]
  -mustache.templates.dir=<span class="hljs-string">'templates'</span>: templates resource directory
  -shutdown.time=<span class="hljs-string">'1.minutes'</span>: Maximum amount of time to <span class="hljs-built_in">wait</span> <span class="hljs-keyword">for</span> pending requests to complete on shutdown
  -tracingEnabled=<span class="hljs-string">'true'</span>: Tracing enabled
</code></pre>
<h2><a id="RESTful_API_Document_using_Swagger_330"></a>RESTful API Document using Swagger</h2>
<ul>
<li>Write your swagger document using <a href="https://github.com/xiaodongw/swagger-finatra">swagger-finatra</a> - <a href="https://github.com/xiaodongw/swagger-finatra#add-document-information-for-you-controller">Add document information for you controller</a></li>
<li>After start server, open document url <a href="http://localhost:9999/api-docs/ui"><code>http://localhost:9999/api-docs/ui</code></a></li>
</ul>
<h2><a id="Remote_Debugging_335"></a>Remote Debugging</h2>
<pre><code class="language-bash">./activator -jvm-debug &lt;port&gt; run
</code></pre>
<p>Reference : <a href="http://stackoverflow.com/questions/19473941/how-to-debug-play-application-using-activator">http://stackoverflow.com/questions/19473941/how-to-debug-play-application-using-activator</a></p>
<h2><a id="Troubleshooting_341"></a>Troubleshooting</h2>
<p>When <code>sbt run</code> or <code>activator run</code> raise dependencies error, clear ivy’s cache files and retry run.</p>
<pre><code class="language-bash">rm -rf ~/.ivy2/cache/
</code></pre>

</body></html>
